name = "nanoaitts-worker"
main = "src/index.js"
compatibility_date = "2024-12-01"
compatibility_flags = ["nodejs_compat"]

# Cloudflare KV Namespace binding for voice cache (optional)
# To enable KV caching, create namespaces and replace the IDs below:
# wrangler kv:namespace create "NANO_AI_TTS_KV"
# wrangler kv:namespace create "NANO_AI_TTS_KV" --preview
[[kv_namespaces]]
binding = "NANO_AI_TTS_KV"
id = "YOUR_KV_NAMESPACE_ID"
preview_id = "YOUR_PREVIEW_KV_NAMESPACE_ID"

# Production environment configuration
[env.production]
name = "nanoaitts-worker"
kv_namespaces = [
  { binding = "NANO_AI_TTS_KV", id = "YOUR_KV_NAMESPACE_ID", preview_id = "YOUR_PREVIEW_KV_NAMESPACE_ID" }
]
vars = { ENVIRONMENT = "production" }

# Development environment configuration  
[env.development]
name = "nanoaitts-worker-dev"
kv_namespaces = [
  { binding = "NANO_AI_TTS_KV", id = "YOUR_DEV_KV_NAMESPACE_ID", preview_id = "YOUR_DEV_PREVIEW_KV_NAMESPACE_ID" }
]
vars = { ENVIRONMENT = "development" }

# Performance limits
limits = { cpu_milliseconds = 50000 }

# Build configuration
[build]
command = "npm install"

# Local development server settings
[dev]
ip = "127.0.0.1"
port = 8787
local_protocol = "http"

# Miniflare configuration for local development
[miniflare]
kv_persist = true
kv_cache_persist = true
cache_persist = true
