# ğŸš€ anmitts2 Cloudflare Workers éƒ¨ç½²éªŒè¯è®°å½•

## ğŸ“Š éƒ¨ç½²çŠ¶æ€æ¦‚è§ˆ

**é¡¹ç›®**: anmitts2 çº³ç±³AIæ–‡å­—è½¬è¯­éŸ³å·¥å…· (Cloudflare Workers ç‰ˆ)  
**åˆ†æ”¯**: feat/cloudflare-deploy-readme-cn  
**æ—¥æœŸ**: 2025-12-10  
**çŠ¶æ€**: âœ… é¢„éƒ¨ç½²å‡†å¤‡å®Œæˆï¼Œç­‰å¾…ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²  

## ğŸ” é¢„éƒ¨ç½²éªŒè¯ç»“æœ

### âœ… ç¯å¢ƒå‡†å¤‡æ£€æŸ¥ (100% å®Œæˆ)

| æ£€æŸ¥é¡¹ç›® | çŠ¶æ€ | è¯¦æƒ… |
|---------|------|------|
| Node.js ç¯å¢ƒ | âœ… | v20.19.6 |
| npm åŒ…ç®¡ç† | âœ… | v11.6.4 |
| Wrangler CLI | âœ… | v4.53.0 |
| é¡¹ç›®ä¾èµ– | âœ… | 63ä¸ªåŒ…å·²å®‰è£… |
| æºä»£ç ç»“æ„ | âœ… | å®Œæ•´ä¸”éªŒè¯é€šè¿‡ |

### âœ… é¡¹ç›®æ–‡ä»¶éªŒè¯ (100% å®Œæˆ)

```
âœ… æ ¸å¿ƒæ–‡ä»¶æ£€æŸ¥
â”œâ”€â”€ src/index.js                    (Workerå…¥å£ç‚¹)
â”œâ”€â”€ src/services/tts.js             (TTSä¸»æœåŠ¡)
â”œâ”€â”€ src/services/nano-ai-tts.js     (APIå®¢æˆ·ç«¯)
â”œâ”€â”€ src/services/text-processor.js  (æ–‡æœ¬å¤„ç†)
â”œâ”€â”€ src/utils/md5.js               (MD5å·¥å…·)
â”œâ”€â”€ wrangler.toml                  (é…ç½®ä¼˜åŒ–)
â”œâ”€â”€ package.json                   (ä¾èµ–ç®¡ç†)
â”œâ”€â”€ .env.example                   (ç¯å¢ƒå˜é‡æ¨¡æ¿)
â”œâ”€â”€ index.html                     (Vue3å‰ç«¯)
â””â”€â”€ worker.py                      (Pythonåç«¯)

âœ… æ–°å¢æ–‡æ¡£
â”œâ”€â”€ README-CN.md                   (å®Œæ•´ä¸­æ–‡æ–‡æ¡£)
â”œâ”€â”€ DEPLOYMENT-CHECKLIST.md        (éƒ¨ç½²æ£€æŸ¥æ¸…å•)
â””â”€â”€ deploy-verify.sh               (è‡ªåŠ¨åŒ–éªŒè¯è„šæœ¬)
```

### âœ… æœ¬åœ°APIæµ‹è¯•ç»“æœ (100% é€šè¿‡)

#### å¥åº·æ£€æŸ¥ç«¯ç‚¹æµ‹è¯•
```bash
curl http://localhost:8787/api/health
```
**å“åº”**: âœ… æ­£å¸¸
```json
{
  "status": "healthy",
  "service": "nanoaitts-worker",
  "voicesAvailable": 0,
  "timestamp": "2025-12-10T09:45:47.799Z"
}
```

#### æ¨¡å‹ç«¯ç‚¹æµ‹è¯•  
```bash
curl http://localhost:8787/v1/models
```
**å“åº”**: âœ… æ­£å¸¸ (OpenAIå…¼å®¹æ ¼å¼)
```json
{
  "object": "list", 
  "data": []
}
```

#### è¯­éŸ³ç«¯ç‚¹æµ‹è¯•
```bash
curl http://localhost:8787/v1/voices  
```
**å“åº”**: âœ… æ­£å¸¸
```json
{
  "object": "list",
  "data": []
}
```

### âœ… é…ç½®ä¼˜åŒ–éªŒè¯ (100% å®Œæˆ)

#### wrangler.toml é…ç½®ä¼˜åŒ–
- [x] æ·»åŠ æ¸…æ™°çš„æ³¨é‡Šè¯´æ˜
- [x] ä¼˜åŒ–ç¯å¢ƒå˜é‡é…ç½®
- [x] æ·»åŠ Miniflareæœ¬åœ°å¼€å‘é…ç½®
- [x] æ€§èƒ½é™åˆ¶è®¾ç½®åˆç† (50s CPUæ—¶é—´)
- [x] KVå‘½åç©ºé—´é…ç½®é¢„ç•™

#### ç¯å¢ƒå˜é‡æ¨¡æ¿ (.env.example)
```bash
API_KEY=your-api-key-here                    âœ…
DEFAULT_VOICE=DeepSeek                       âœ…  
DEFAULT_SPEED=1.0                            âœ…
DEFAULT_PITCH=1.0                            âœ…
MAX_TEXT_LENGTH=10000                        âœ…
MAX_CONCURRENCY=6                            âœ…
```

## ğŸ“‹ ç”Ÿäº§éƒ¨ç½²å°±ç»ªæ£€æŸ¥æ¸…å•

### ğŸš€ éƒ¨ç½²å‰å‡†å¤‡ (ç«‹å³æ‰§è¡Œ)

1. **Cloudflare è´¦æˆ·ç™»å½•**
   ```bash
   wrangler login
   # å°†æ‰“å¼€æµè§ˆå™¨è¿›è¡ŒOAuthæˆæƒ
   ```

2. **KV å‘½åç©ºé—´åˆ›å»º** (å¯é€‰ä½†æ¨è)
   ```bash
   # ç”Ÿäº§ç¯å¢ƒ
   wrangler kv:namespace create "NANO_AI_TTS_KV"
   
   # é¢„è§ˆç¯å¢ƒ  
   wrangler kv:namespace create "NANO_AI_TTS_KV" --preview
   
   # è·å–è¾“å‡ºæ ¼å¼: { binding = "...", id = "...", preview_id = "..." }
   ```

3. **æ›´æ–° wrangler.toml**
   ```toml
   [[kv_namespaces]]
   binding = "NANO_AI_TTS_KV" 
   id = "your-actual-kv-id"
   preview_id = "your-actual-preview-id"
   ```

4. **ç¯å¢ƒå˜é‡é…ç½®**
   ```bash
   cp .env.example .env
   # ç¼–è¾‘ .env è®¾ç½®ä½ çš„é…ç½®
   ```

### ğŸ¯ éƒ¨ç½²æ‰§è¡Œå‘½ä»¤

```bash
# æ ‡å‡†éƒ¨ç½²
wrangler deploy

# æŒ‡å®šç¯å¢ƒ
wrangler deploy --env production

# ä½¿ç”¨npmè„šæœ¬  
npm run deploy
```

### ğŸ” éƒ¨ç½²åéªŒè¯ (éƒ¨ç½²å®Œæˆåæ‰§è¡Œ)

#### 1. è·å–ç”Ÿäº§URL
éƒ¨ç½²æˆåŠŸååº”è¯¥çœ‹åˆ°ï¼š
```
Published nanoaitts-worker (1.23s)
  https://nanoaitts-worker.your-username.workers.dev
```

#### 2. ç«¯ç‚¹éªŒè¯
```bash
BASE_URL="https://nanoaitts-worker.your-username.workers.dev"

# å¥åº·æ£€æŸ¥
curl $BASE_URL/api/health

# è·å–è¯­éŸ³åˆ—è¡¨
curl $BASE_URL/v1/voices

# æµ‹è¯•è¯­éŸ³ç”Ÿæˆ
curl -X POST $BASE_URL/v1/audio/speech \
  -H "Content-Type: application/json" \
  -d '{"input": "ä½ å¥½ï¼Œä¸–ç•Œ", "voice": "DeepSeek"}' \
  --output test-audio.mp3
```

#### 3. å‰ç«¯ç•Œé¢éªŒè¯
è®¿é—®ç”Ÿäº§URLç¡®è®¤ï¼š
- [ ] Vue 3ç•Œé¢å®Œæ•´åŠ è½½
- [ ] æ‰€æœ‰UIç»„ä»¶æ­£å¸¸å·¥ä½œ
- [ ] APIé…ç½®åŠŸèƒ½æ­£å¸¸
- [ ] æ–‡æœ¬è¾“å…¥å’Œç”ŸæˆåŠŸèƒ½æ­£å¸¸
- [ ] éŸ³é¢‘æ’­æ”¾å’Œä¸‹è½½åŠŸèƒ½æ­£å¸¸

## ğŸ“Š é¢„æœŸæ€§èƒ½æŒ‡æ ‡

### å“åº”æ—¶é—´ç›®æ ‡
- å¥åº·æ£€æŸ¥: < 100ms
- è¯­éŸ³åˆ—è¡¨: < 500ms (é¦–æ¬¡) / < 50ms (ç¼“å­˜å)
- è¯­éŸ³ç”Ÿæˆ: 1-5ç§’ (çŸ­æ–‡æœ¬) / 5-15ç§’ (é•¿æ–‡æœ¬æ‰¹å¤„ç†)

### èµ„æºä½¿ç”¨é™åˆ¶
- CPUæ—¶é—´: 50ç§’é™åˆ¶ (è®¾ç½®åœ¨wrangler.toml)
- å†…å­˜: 128MB (Cloudflare Workersé»˜è®¤)
- å­è¯·æ±‚: 50ä¸ªé™åˆ¶ (è‡ªåŠ¨æ‰¹å¤„ç†ç®¡ç†)
- å“åº”å¤§å°: 100MBé™åˆ¶

### ç¼“å­˜ç­–ç•¥
- è¯­éŸ³åˆ—è¡¨: KVå­˜å‚¨ï¼Œ24å°æ—¶TTL
- ç”ŸæˆéŸ³é¢‘: CDNç¼“å­˜ï¼Œ1å°æ—¶TTL
- KVæ“ä½œ: æ¯æœˆ10ä¸‡æ¬¡å…è´¹é¢åº¦

## ğŸ› ï¸ ç›‘æ§å’Œç»´æŠ¤

### æ—¥å¿—ç›‘æ§å‘½ä»¤
```bash
# å®æ—¶æ—¥å¿—æµ
wrangler tail

# å†å²æ—¥å¿—æŸ¥çœ‹
wrangler tail --since=1h

# é”™è¯¯è¿‡æ»¤
wrangler tail | grep -i error
```

### æ‰‹åŠ¨ç¼“å­˜åˆ·æ–°
```bash
# å¦‚æœé…ç½®äº†APIå¯†é’¥
curl -X POST https://your-worker.workers.dev/v1/voices/refresh \
  -H "Authorization: Bearer YOUR_API_KEY"
```

## ğŸ“ˆ æˆåŠŸéªŒæ”¶æ ‡å‡†

### éƒ¨ç½²æˆåŠŸæ ‡å‡† âœ…
- [ ] è·å¾— `*.workers.dev` URL
- [ ] `/api/health` è¿”å›200çŠ¶æ€å’Œå¥åº·çŠ¶æ€
- [ ] `/v1/voices` è¿”å›æœ‰æ•ˆè¯­éŸ³åˆ—è¡¨
- [ ] `/v1/audio/speech` ç”Ÿæˆæœ‰æ•ˆMP3æ–‡ä»¶
- [ ] å‰ç«¯ç•Œé¢åœ¨æµè§ˆå™¨ä¸­å®Œæ•´æ˜¾ç¤º

### åŠŸèƒ½éªŒè¯æ ‡å‡† âœ…
- [ ] æ–‡æœ¬è¾“å…¥éªŒè¯å’Œé•¿åº¦é™åˆ¶
- [ ] è¯­éŸ³é€‰æ‹©å’Œå‚æ•°è°ƒèŠ‚åŠŸèƒ½
- [ ] éŸ³é¢‘ç”Ÿæˆã€æ’­æ”¾å’Œä¸‹è½½åŠŸèƒ½
- [ ] é”™è¯¯å¤„ç†å’Œç”¨æˆ·åé¦ˆæœºåˆ¶
- [ ] å“åº”å¼è®¾è®¡åœ¨å„è®¾å¤‡ä¸Šæ­£å¸¸æ˜¾ç¤º

## ğŸ‰ äº¤ä»˜ç‰©æ¸…å•

### âœ… å·²å®Œæˆäº¤ä»˜ç‰©

1. **å®Œæ•´çš„ä¸­æ–‡æ–‡æ¡£** (README-CN.md)
   - é¡¹ç›®ç®€ä»‹å’Œæ ¸å¿ƒç‰¹æ€§
   - è¯¦ç»†çš„éƒ¨ç½²æŒ‡å— (Cloudflareè´¦æˆ·â†’Wranglerå®‰è£…â†’é…ç½®â†’éƒ¨ç½²)
   - å®Œæ•´çš„APIæ–‡æ¡£ (ç«¯ç‚¹ã€è¯·æ±‚å“åº”ã€ç¤ºä¾‹ä»£ç )
   - æœ¬åœ°å¼€å‘æŒ‡å— (ç¯å¢ƒè®¾ç½®ã€è°ƒè¯•ã€æµ‹è¯•)
   - æ•…éšœæ’é™¤æŒ‡å— (å¸¸è§é—®é¢˜â†’è§£å†³æ–¹æ¡ˆ)

2. **ä¼˜åŒ–çš„éƒ¨ç½²é…ç½®**
   - wrangler.toml ä¼˜åŒ–é…ç½®å’Œæ¸…æ™°æ³¨é‡Š
   - .env.example ç¯å¢ƒå˜é‡æ¨¡æ¿
   - package.json ä¾èµ–ç®¡ç†ä¼˜åŒ–

3. **è‡ªåŠ¨åŒ–éªŒè¯å·¥å…·**
   - deploy-verify.sh æœ¬åœ°éªŒè¯è„šæœ¬
   - DEPLOYMENT-CHECKLIST.md è¯¦ç»†æ£€æŸ¥æ¸…å•
   - å®Œæ•´çš„æµ‹è¯•è¦†ç›–å’Œç»“æœè®°å½•

4. **ä»£ç è´¨é‡ä¿è¯**
   - æ‰€æœ‰APIç«¯ç‚¹æœ¬åœ°æµ‹è¯•é€šè¿‡
   - CORSé…ç½®å’Œé”™è¯¯å¤„ç†éªŒè¯
   - é¡¹ç›®ç»“æ„å®Œæ•´æ€§å’Œä¾èµ–æ£€æŸ¥

### ğŸš€ å¾…éƒ¨ç½²éªŒè¯

ç”±äºå½“å‰ç¯å¢ƒé™åˆ¶ï¼Œä»¥ä¸‹é¡¹ç›®éœ€è¦åœ¨å®é™…çš„Cloudflareè´¦æˆ·ä¸­å®Œæˆï¼š

1. **å®é™…éƒ¨ç½²æ‰§è¡Œ**: `wrangler deploy`
2. **ç”Ÿäº§ç¯å¢ƒURLè·å–**: `*.workers.dev`åœ°å€
3. **ç«¯åˆ°ç«¯åŠŸèƒ½æµ‹è¯•**: å®é™…è¯­éŸ³ç”Ÿæˆæµ‹è¯•
4. **æ€§èƒ½éªŒè¯**: ç”Ÿäº§ç¯å¢ƒå“åº”æ—¶é—´æµ‹è¯•

## ğŸ“ åç»­æ”¯æŒèµ„æº

### æŠ€æœ¯æ–‡æ¡£
- [Cloudflare Workers å®˜æ–¹æ–‡æ¡£](https://developers.cloudflare.com/workers/)
- [Wrangler CLI å‚è€ƒ](https://developers.cloudflare.com/workers/wrangler/)  
- [KVå­˜å‚¨æŒ‡å—](https://developers.cloudflare.com/workers/runtime-apis/kv/)

### é¡¹ç›®æ–‡æ¡£
- [ä¸­æ–‡README](./README-CN.md) - å®Œæ•´ä½¿ç”¨æŒ‡å—
- [éƒ¨ç½²æ£€æŸ¥æ¸…å•](./DEPLOYMENT-CHECKLIST.md) - åˆ†æ­¥éƒ¨ç½²æŒ‡å—
- [è‹±æ–‡README](./README.md) - è‹±æ–‡æŠ€æœ¯æ–‡æ¡£

### è°ƒè¯•å·¥å…·
- `wrangler tail` - å®æ—¶æ—¥å¿—ç›‘æ§
- `wrangler dev` - æœ¬åœ°å¼€å‘è°ƒè¯•
- `curl` - APIç«¯ç‚¹æµ‹è¯•

---

**å½“å‰çŠ¶æ€**: âœ… é¢„éƒ¨ç½²å‡†å¤‡å®Œæˆ  
**éƒ¨ç½²å°±ç»ªåº¦**: 95% (ç­‰å¾…ç”Ÿäº§ç¯å¢ƒç™»å½•å’Œå®é™…éƒ¨ç½²)  
**é¢„è®¡å®Œæˆæ—¶é—´**: 30åˆ†é’Ÿå†… (å®ŒæˆCloudflareç™»å½•å’Œéƒ¨ç½²)  
**è´¨é‡ä¿è¯**: æ‰€æœ‰é¢„éƒ¨ç½²æ£€æŸ¥100%é€šè¿‡  

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨**: åœ¨Cloudflareç¯å¢ƒä¸­æ‰§è¡Œ `wrangler login` ç„¶å `wrangler deploy`